<!-- <!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Jolo Delivery â€“ Health Status</title>
	<link rel="stylesheet" href="/static/css/health.css">

	<meta http-equiv="refresh" content="10">
</head>
<body>
	<div class="card">
		<h1>ğŸš€ Jolo Delivery API</h1>

		<p class="status {{ if .dbOK }}ok{{ else }}bad{{ end }}">
			{{ if .dbOK }}âœ… Server Healthy{{ else }}âŒ Server Unhealthy{{ end }}
		</p>

		<div class="meta-row">
			<span class="meta-label">ğŸ—„ï¸ Database</span>
			<span class="meta-value {{ if .dbOK }}db-ok{{ else }}db-bad{{ end }}">
				{{ if .dbOK }}Connected{{ else }}Down{{ end }}
			</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">â±ï¸ Uptime</span>
			<span class="meta-value uptime">{{ .uptime }}</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ’¾ Memory</span>
			<span class="meta-value mem">{{ .memUsageMB }} MB</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ·ï¸ Version</span>
			<span class="meta-value">{{ .version }}</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ•’ Checked</span>
			<span class="meta-value">{{ .time }}</span>
		</div>
	</div>
</body>
</html> -->



<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Jolo Delivery â€“ Health Status</title>
	<link rel="stylesheet" href="/static/css/health.css">
</head>
<body>
	<div class="card">
		<h1>ğŸš€ Jolo Delivery API</h1>

		<p id="server-status" class="status ok">Server is Healthy</p>

		<div class="meta-row">
			<span class="meta-label">ğŸ—„ï¸ Database</span>
			<span id="db-status" class="meta-value db-ok">Connected</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">â±ï¸ Uptime</span>
			<span id="uptime" class="meta-value uptime">0s</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ’¾ Memory</span>
			<span id="mem" class="meta-value mem">0 MB</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ·ï¸ Version</span>
			<span id="version" class="meta-value">{{ .version }}</span>
		</div>

		<div class="meta-row">
			<span class="meta-label">ğŸ•’ Checked</span>
			<span id="checked-time" class="meta-value">{{ .time }}</span>
		</div>
	</div>

	<script>
		async function fetchHealth() {
			try {
				const res = await fetch("/health/json");
				const data = await res.json();

				// Server status
				const serverStatus = document.getElementById("server-status");
				serverStatus.className = "status " + (data.dbOK ? "ok" : "bad");
				serverStatus.textContent = data.dbOK ? "Server is Healthy" : "Server is Unhealthy";

				// DB
				const db = document.getElementById("db-status");
				db.className = "meta-value " + (data.dbOK ? "db-ok" : "db-bad");
				db.textContent = data.dbOK ? "Connected" : "Down";

				// Uptime
				const uptime = document.getElementById("uptime");
				uptime.textContent = data.uptime;

				// Memory
				const mem = document.getElementById("mem");
				mem.textContent = data.memUsageMB + " MB";

				// Version
				const version = document.getElementById("version");
				version.textContent = data.version;

				// Checked time
				const checked = document.getElementById("checked-time");
				checked.textContent = data.time;
			} catch (err) {
				console.error("Error fetching health data:", err);
			}
		}

		// Fetch immediately and every 5 seconds
		fetchHealth();
		setInterval(fetchHealth, 5000);
	</script>
</body>
</html>

